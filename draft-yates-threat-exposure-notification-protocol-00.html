<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Threat Exposure Notification Protocol</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Notational Conventions">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Threat Exposure Notification">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Tracking Exposures (Non-Normative)">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Diagnosis (Non-Normative)">
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Protocol Flow">
<link href="#rfc.section.3" rel="Chapter" title="3 Threat Exposure Notification Server Metadata">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Threat Exposure Notification Server Configuration Document">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Obtaining Threat Exposure Notification Server Configuration Document">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Threat Exposure Notification Server Configuration Request">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Threat Exposure Notification Server Configuration Response">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Threat Exposure Notification Server Configuration Validation">
<link href="#rfc.section.4" rel="Chapter" title="4 Threat Descriptors">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Threat Descriptor Properties">
<link href="#rfc.section.5" rel="Chapter" title="5 Assertions">
<link href="#rfc.section.6" rel="Chapter" title="6 Uploading Diagnosis Keys">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Upload Request">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Upload Validation">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Upload Response">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Upload Error Response">
<link href="#rfc.section.7" rel="Chapter" title="7 Querying Exposure">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Query Request">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Query Validation">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 Query Response">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Query Error Response">
<link href="#rfc.section.8" rel="Chapter" title="8 Fetching Diagnosis Keys">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Fetch Request">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Fetch Validation">
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 Fetch Response">
<link href="#rfc.section.8.4" rel="Chapter" title="8.4 Fetch Error">
<link href="#rfc.section.9" rel="Chapter" title="9 Revoking Diagnosis Keys">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Revoke Request">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Revoke Validation">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Revoke Response">
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 Revoke Error">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Authentication and Authorization">
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Privacy Considerations">
<link href="#rfc.section.10.3" rel="Chapter" title="10.3 TLS Requirements">
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations">
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 Threat Exposure Notification Server Metadata Registry">
<link href="#rfc.section.11.1.1" rel="Chapter" title="11.1.1 Registration Template">
<link href="#rfc.section.11.1.2" rel="Chapter" title="11.1.2 Initial Registry Contents">
<link href="#rfc.section.11.2" rel="Chapter" title="11.2 Well-Known URI Registry">
<link href="#rfc.section.11.2.1" rel="Chapter" title="11.2.1 Registry Contents">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.references.1" rel="Chapter" title="12.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="12.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Configuration Examples (Non-normative)">
<link href="#rfc.appendix.A.1" rel="Chapter" title="A.1 Example Configuration Request">
<link href="#rfc.appendix.A.2" rel="Chapter" title="A.2 Example Configuration Response">
<link href="#rfc.appendix.B" rel="Chapter" title="B Upload Examples (Non-normative)">
<link href="#rfc.appendix.B.1" rel="Chapter" title="B.1 Example Upload Request">
<link href="#rfc.appendix.B.2" rel="Chapter" title="B.2 Example Upload Successful Response">
<link href="#rfc.appendix.B.3" rel="Chapter" title="B.3 Example Upload Empty Response">
<link href="#rfc.appendix.B.4" rel="Chapter" title="B.4 Example Upload Error Response">
<link href="#rfc.appendix.C" rel="Chapter" title="C Query Examples (Non-normative)">
<link href="#rfc.appendix.C.1" rel="Chapter" title="C.1 Example Query Request">
<link href="#rfc.appendix.C.2" rel="Chapter" title="C.2 Example Query Response">
<link href="#rfc.appendix.C.3" rel="Chapter" title="C.3 Example Query Error Response">
<link href="#rfc.appendix.D" rel="Chapter" title="D Fetch Examples (Non-normative)">
<link href="#rfc.appendix.D.1" rel="Chapter" title="D.1 Example Fetch Request">
<link href="#rfc.appendix.D.2" rel="Chapter" title="D.2 Example Fetch Response">
<link href="#rfc.appendix.D.3" rel="Chapter" title="D.3 Example Fetch Error Response">
<link href="#rfc.appendix.E" rel="Chapter" title="E Revoke Examples (Non-normative)">
<link href="#rfc.appendix.E.1" rel="Chapter" title="E.1 Example Revoke Request">
<link href="#rfc.appendix.E.2" rel="Chapter" title="E.2 Example Revoke Successful Response">
<link href="#rfc.appendix.E.3" rel="Chapter" title="E.3 Example Revoke Empty Response">
<link href="#rfc.appendix.E.4" rel="Chapter" title="E.4 Example Revoke Error Response">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.44.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Yates, S. and Y. Salomon" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-yates-threat-exposure-notification-protocol-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2020-05-01" />
  <meta name="dct.abstract" content="This specification defines a protocol for an HTTP- and JSON-based Threat Exposure Notification by outlining how clients upload diagnosis keys, query exposure, revoke diagnosis keys and fetch diagnosis keys from a server.   " />
  <meta name="description" content="This specification defines a protocol for an HTTP- and JSON-based Threat Exposure Notification by outlining how clients upload diagnosis keys, query exposure, revoke diagnosis keys and fetch diagnosis keys from a server.   " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">S. Yates</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Y. Salomon</td>
</tr>
<tr>
<td class="left">Intended status: Experimental</td>
<td class="right">Switchbit, Inc.</td>
</tr>
<tr>
<td class="left">Expires: November 2, 2020</td>
<td class="right">May 1, 2020</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Threat Exposure Notification Protocol<br />
  <span class="filename">draft-yates-threat-exposure-notification-protocol-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This specification defines a protocol for an HTTP- and JSON-based Threat Exposure Notification by outlining how clients upload diagnosis keys, query exposure, revoke diagnosis keys and fetch diagnosis keys from a server.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on November 2, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2020 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Notational Conventions</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Threat Exposure Notification</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Tracking Exposures (Non-Normative)</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Diagnosis (Non-Normative)</a>
</li>
<li>1.5.   <a href="#rfc.section.1.5">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Protocol Flow</a>
</li>
<li>3.   <a href="#rfc.section.3">Threat Exposure Notification Server Metadata</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Threat Exposure Notification Server Configuration Document</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Obtaining Threat Exposure Notification Server Configuration Document</a>
</li>
<ul><li>3.2.1.   <a href="#rfc.section.3.2.1">Threat Exposure Notification Server Configuration Request</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Threat Exposure Notification Server Configuration Response</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Threat Exposure Notification Server Configuration Validation</a>
</li>
</ul></ul><li>4.   <a href="#rfc.section.4">Threat Descriptors</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Threat Descriptor Properties</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Assertions</a>
</li>
<li>6.   <a href="#rfc.section.6">Uploading Diagnosis Keys</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Upload Request</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Upload Validation</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Upload Response</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">Upload Error Response</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Querying Exposure</a>
</li>
<ul><li>7.1.   <a href="#rfc.section.7.1">Query Request</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Query Validation</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">Query Response</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">Query Error Response</a>
</li>
</ul><li>8.   <a href="#rfc.section.8">Fetching Diagnosis Keys</a>
</li>
<ul><li>8.1.   <a href="#rfc.section.8.1">Fetch Request</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Fetch Validation</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">Fetch Response</a>
</li>
<li>8.4.   <a href="#rfc.section.8.4">Fetch Error</a>
</li>
</ul><li>9.   <a href="#rfc.section.9">Revoking Diagnosis Keys</a>
</li>
<ul><li>9.1.   <a href="#rfc.section.9.1">Revoke Request</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Revoke Validation</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">Revoke Response</a>
</li>
<li>9.4.   <a href="#rfc.section.9.4">Revoke Error</a>
</li>
</ul><li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<ul><li>10.1.   <a href="#rfc.section.10.1">Authentication and Authorization</a>
</li>
<li>10.2.   <a href="#rfc.section.10.2">Privacy Considerations</a>
</li>
<li>10.3.   <a href="#rfc.section.10.3">TLS Requirements</a>
</li>
</ul><li>11.   <a href="#rfc.section.11">IANA Considerations</a>
</li>
<ul><li>11.1.   <a href="#rfc.section.11.1">Threat Exposure Notification Server Metadata Registry</a>
</li>
<ul><li>11.1.1.   <a href="#rfc.section.11.1.1">Registration Template</a>
</li>
<li>11.1.2.   <a href="#rfc.section.11.1.2">Initial Registry Contents</a>
</li>
</ul><li>11.2.   <a href="#rfc.section.11.2">Well-Known URI Registry</a>
</li>
<ul><li>11.2.1.   <a href="#rfc.section.11.2.1">Registry Contents</a>
</li>
</ul></ul><li>12.   <a href="#rfc.references">References</a>
</li>
<ul><li>12.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>12.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Configuration Examples (Non-normative)</a>
</li>
<ul><li>A.1.   <a href="#rfc.appendix.A.1">Example Configuration Request</a>
</li>
<li>A.2.   <a href="#rfc.appendix.A.2">Example Configuration Response</a>
</li>
</ul><li>Appendix B.   <a href="#rfc.appendix.B">Upload Examples (Non-normative)</a>
</li>
<ul><li>B.1.   <a href="#rfc.appendix.B.1">Example Upload Request</a>
</li>
<li>B.2.   <a href="#rfc.appendix.B.2">Example Upload Successful Response</a>
</li>
<li>B.3.   <a href="#rfc.appendix.B.3">Example Upload Empty Response</a>
</li>
<li>B.4.   <a href="#rfc.appendix.B.4">Example Upload Error Response</a>
</li>
</ul><li>Appendix C.   <a href="#rfc.appendix.C">Query Examples (Non-normative)</a>
</li>
<ul><li>C.1.   <a href="#rfc.appendix.C.1">Example Query Request</a>
</li>
<li>C.2.   <a href="#rfc.appendix.C.2">Example Query Response</a>
</li>
<li>C.3.   <a href="#rfc.appendix.C.3">Example Query Error Response</a>
</li>
</ul><li>Appendix D.   <a href="#rfc.appendix.D">Fetch Examples (Non-normative)</a>
</li>
<ul><li>D.1.   <a href="#rfc.appendix.D.1">Example Fetch Request</a>
</li>
<li>D.2.   <a href="#rfc.appendix.D.2">Example Fetch Response</a>
</li>
<li>D.3.   <a href="#rfc.appendix.D.3">Example Fetch Error Response</a>
</li>
</ul><li>Appendix E.   <a href="#rfc.appendix.E">Revoke Examples (Non-normative)</a>
</li>
<ul><li>E.1.   <a href="#rfc.appendix.E.1">Example Revoke Request</a>
</li>
<li>E.2.   <a href="#rfc.appendix.E.2">Example Revoke Successful Response</a>
</li>
<li>E.3.   <a href="#rfc.appendix.E.3">Example Revoke Empty Response</a>
</li>
<li>E.4.   <a href="#rfc.appendix.E.4">Example Revoke Error Response</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#Intro" id="Intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Contact Tracing is a technique used by public health authorities to measure and contain the spread of infectious diseases (<a href="#who" class="xref">[who]</a>). It requires gathering information from infected individuals about the people they've previously been in contact with. These individuals can then be notified by public health authorities to take appropriate safety measures, such as undertaking self-quarantine and getting tested.  </p>
<p id="rfc.section.1.p.2">Technology can play an important role in contact tracing efforts. Mobile devices can be used in an automated and scalable way to help determine who has been exposed to a person that later is deemed infectious and sending a notification with instructions on next steps. Health authorities can then use this information to help control the spread of infectious diseases.  </p>
<p id="rfc.section.1.p.3">For any such technology to work requires sufficient adoption in the population. Concerns about user data privacy and sovereignty may hamper adoption rates. It is therefore imperative that any such solution must include a robust framework for respecting user rights, complying with privacy regulations and protecting sensitive data.  </p>
<p id="rfc.section.1.p.4">The Threat Exposure Notification Protocol (TENP) is a simple HTTP- and JSON-based protocol for client-server communication of information to determine if a user has been exposed to a threat.  It enables clients to upload and query such information from a server in an interoperable, secure, and REST-like manner with support for data privacy.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Notational Conventions</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a> when, and only when, they appear in all capitals, as shown here.  </p>
<p id="rfc.section.1.1.p.2">Throughout this document, figures may contain spaces and extra line wrapping to improve readability and accommodate space limitations.  Similarly, some URIs contained within examples have been shortened for space and readability reasons (as indicated by "...").  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Threat Exposure Notification</h1>
<pre>
                        Unexposed
                            +
                            |
                            v
                         Exposed
                          +  +
                          |  |
                  +-------+  +----------+
                  |                     |
                  v                     v
              Infected &lt;----------+ Uninfected
               + + +
               | | |
    +----------+ | +---------------+
    |            |                 |
    v            v                 v
Deceased &lt;--+ Diagnosed +----&gt; Recovered
</pre>
<p></p>

<p>Figure 1: Exposure Flow</p>
<p id="rfc.section.1.2.p.2">Threat Exposure Notification Service includes App, Client, Server, other enabling technologies and authorities.  </p>
<p id="rfc.section.1.2.p.3">Threat Exposure Notification App runs on a device operated by a user and leverages the protocol for communication between the Threat Exposure Notification Client it implements and the Threat Exposure Notification Server </p>
<p id="rfc.section.1.2.p.4">User uses or accesses the Threat Exposure Notification Service via an app installed on their device </p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#Tracking" id="Tracking">Tracking Exposures (Non-Normative)</a>
</h1>
<p id="rfc.section.1.3.p.1">This protocol does not specify a method by which clients trace potential exposures. Several established approaches exist varying in the underlying data and technology interface used. The two most common data sources used are Bluetooth proximity data, and geo location plus timestamp.  </p>
<p id="rfc.section.1.3.p.2">Privacy and security are a major concern and all established approaches ensure Personal Identifiable Information (PII) is protected by leveraging a combination of measures such as only storing such information locally on the client, encrypting information everywhere, and using cryptographically random keys where possible.  </p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#Diagnosis" id="Diagnosis">Diagnosis (Non-Normative)</a>
</h1>
<p id="rfc.section.1.4.p.1">This protocol does not specify a method for testing or diagnosis of a threat nor does it specify a process of authorization to upload diagnosis keys. Several approaches have been suggested elsewhere ranging from self declared to tightly controlled authorization managed by trusted authorities (for example <a href="#pact" class="xref">[pact]</a>).  </p>
<h1 id="rfc.section.1.5">
<a href="#rfc.section.1.5">1.5.</a> <a href="#Terminology" id="Terminology">Terminology</a>
</h1>
<p id="rfc.section.1.5.p.1">This specification defines the following terms: </p>

<dl>
<dt>Threat Exposure Notification Client</dt>
<dd style="margin-left: 8">
<br> A client that implements this protocol.  </dd>
<dt>Threat Exposure Notification Server</dt>
<dd style="margin-left: 8">
<br> A server that implements this protocol.  </dd>
<dt>Infected</dt>
<dd style="margin-left: 8">
<br> A property of a person denoting that they are affected by a threat (although possibly not diagnosed).  </dd>
<dt>Diagnosis</dt>
<dd style="margin-left: 8">
<br> A property of a person denoting their status with respect to a registered threat based on the outcome of a registered procedure.  </dd>
<dt>Exposure</dt>
<dd style="margin-left: 8">
<br> The act of coming in contact with an infected user.  </dd>
<dt>Threat</dt>
<dd style="margin-left: 8">
<br> A harmful vector, contagion, infectious disease, or other concern for authorities.  </dd>
<dt>Key</dt>
<dd style="margin-left: 8">
<br> Keys belong to a device or app, that belong to a user.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#Flow" id="Flow">Protocol Flow</a>
</h1>
<pre>
+----------+                   +----------+
|          |                   |          |
|          |                   |          |
|          |--(A)- METADATA --&gt;|          |
|          |--(B)- UPLOAD ----&gt;|          |
|  Client  |--(C)- QUERY -----&gt;|  Server  |
|          |--(D)- FETCH -----&gt;|          |
|          |--(E)- REVOKE ----&gt;|          |
|          |                   |          |
|          |                   |          |
+----------+                   +----------+
                </pre>
<p>Figure 2: Abstract Protocol Flow</p>
<p></p>

<ul>
<li>(A) A client obtains the Threat Exposure Notification Server Configuration Document from server(s).  </li>
<li>(B) A client uploads diagnosed keys to server(s).  </li>
<li>(C) A client queries exposure from server(s).  </li>
<li>(D) A client fetches diagnosed keys from server(s).  </li>
<li>(E) A client revokes access to diagnosed keys from server(s).  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#Metadata" id="Metadata">Threat Exposure Notification Server Metadata</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#MetadataDoc" id="MetadataDoc">Threat Exposure Notification Server Configuration Document</a>
</h1>
<p id="rfc.section.3.1.p.1">A server MUST host a Threat Exposure Notification Server Configuration Document describing its configuration. The following server metadata values are used by this specification and are registered in the IANA "Threat Exposure Notification Servers Metadata" registry established in <a href="#MetadataReg" class="xref">Section 11.1</a>: </p>

<dl>
<dt>supports_query</dt>
<dd style="margin-left: 8">
<br> REQUIRED.  Boolean value indicating whether the server supports the Query operation.  </dd>
<dt>query_endpoint</dt>
<dd style="margin-left: 8">
<br> RECOMMENDED.  URL of the server's Query endpoint.  </dd>
<dt>supports_upload</dt>
<dd style="margin-left: 8">
<br> REQUIRED.  Boolean value indicating whether the server supports the Upload operation.  </dd>
<dt>upload_endpoint</dt>
<dd style="margin-left: 8">
<br> RECOMMENDED.  URL of the server's Fetch endpoint.  </dd>
<dt>supports_fetch</dt>
<dd style="margin-left: 8">
<br> REQUIRED.  Boolean value indicating whether the server supports the Fetch operation.  </dd>
<dt>fetch_endpoint</dt>
<dd style="margin-left: 8">
<br> RECOMMENDED.  URL of the server's Query endpoint.  </dd>
<dt>supports_revoke</dt>
<dd style="margin-left: 8">
<br> REQUIRED.  Boolean value indicating whether the server supports the Revoke operation.  </dd>
<dt>revoke_endpoint</dt>
<dd style="margin-left: 8">
<br> RECOMMENDED.  URL of the server's Revoke endpoint.  </dd>
<dt>threats_supported</dt>
<dd style="margin-left: 8">
<br> REQUIRED.  An array of strings of the threats the server supports.  <a href="#Descriptors" class="xref">Section 4</a> </dd>
<dt>keys_supported</dt>
<dd style="margin-left: 8">
<br> REQUIRED.  An array of strings of the keys the server supports.  </dd>
<dt>assertions_supported</dt>
<dd style="margin-left: 8">
<br> RECOMMENDED.  An array of strings of the Assertions the server supports.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.1.p.2">Clients that do not recognize Metadata values SHALL ignore them and not generate an error.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#ObtainingMetadata" id="ObtainingMetadata">Obtaining Threat Exposure Notification Server Configuration Document</a>
</h1>
<p id="rfc.section.3.2.p.1">Servers MUST make a JSON document <a href="#RFC8259" class="xref">[RFC8259]</a> available at the path <samp>/.well-known/threat-exposure-configuration</samp>. The syntax and semantics of <samp>.well-known</samp> are defined in <a href="#RFC8615" class="xref">[RFC8615]</a>.  </p>
<p><samp>threat-exposure-configuration</samp> MUST point to a JSON document <a href="#RFC8259" class="xref">[RFC8259]</a> compliant with this specification and MUST be returned using the <samp>application/json</samp> content type.  </p>
<p id="rfc.section.3.2.p.3">The well-known URI path suffix used MUST be registered in the IANA "Well-Known URIs" registry <a href="#IANA.well-known" class="xref">[IANA.well-known]</a>.  </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Threat Exposure Notification Server Configuration Request</h1>
<p id="rfc.section.3.2.1.p.1">A Threat Exposure Notification Server Configuration Document MUST be queried using an HTTP GET request at the previously specified path.  </p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> Threat Exposure Notification Server Configuration Response</h1>
<p id="rfc.section.3.2.2.p.1">The response is a JSON object <a href="#RFC8259" class="xref">[RFC8259]</a> containing a set of claims about the server's configuration, including all necessary endpoints and supported information. A successful response MUST use the 200 OK HTTP status code and return a JSON object <a href="#RFC8259" class="xref">[RFC8259]</a> using the <samp>application/json</samp> content type that contains a set of claims as its members that are a subset of the Metadata values defined in <a href="#Metadata" class="xref">Section 3</a>.  </p>
<p id="rfc.section.3.2.2.p.2">Other claims MAY also be returned and clients MUST ignore any claims not recognized.</p>
<p id="rfc.section.3.2.2.p.3">Clients SHOULD follow redirected requests.</p>
<p id="rfc.section.3.2.2.p.4">Claims that return multiple values are represented as JSON arrays.</p>
<p id="rfc.section.3.2.2.p.5">Claims with zero elements MUST be omitted from the response.</p>
<p id="rfc.section.3.2.2.p.6">An error response uses the applicable HTTP status code value.</p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> Threat Exposure Notification Server Configuration Validation</h1>
<p id="rfc.section.3.2.3.p.1">If any of the validation procedures defined in this specification fail, any operations requiring the information that failed to correctly validate MUST be aborted and the information that failed to validate MUST NOT be used.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#Descriptors" id="Descriptors">Threat Descriptors</a>
</h1>
<p id="rfc.section.4.p.1">This section describes a JSON document <a href="#RFC8259" class="xref">[RFC8259]</a> format for describing threats. The format is based on the JRD document format specified in <a href="#RFC6415" class="xref">[RFC6415]</a>.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#ThreatProperties" id="ThreatProperties">Threat Descriptor Properties</a>
</h1>
<p id="rfc.section.4.1.p.1">A Threat Descriptor has the following properties: </p>

<dl>
<dt>https://tenprotocol.org/props/threat/name</dt>
<dd style="margin-left: 8">
<br><br> REQUIRED. The name of the threat.  </dd>
<dt>https://tenprotocol.org/props/threat/description</dt>
<dd style="margin-left: 8">
<br><br> REQUIRED. A short description of the threat.  </dd>
<dt>https://tenprotocol.org/props/threat/symptoms</dt>
<dd style="margin-left: 8">
<br><br> RECOMMENDED. A comma-separated list of string labels that describe symptoms of the threat.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#Assertions" id="Assertions">Assertions</a>
</h1>
<p id="rfc.section.5.p.1">Assertions can be attached to Requests to provide additional information about the request.  The key of an Assertion is a URI. Clients MUST NOT attempt to fetch the fetch the resource specified by the URI. New Assertions can be created by specifying new URI's. The specifier MUST control the URI space.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#Upload" id="Upload">Uploading Diagnosis Keys</a>
</h1>
<p id="rfc.section.6.p.1">The client MAY upload to the server the diagnosis keys associated to a diagnosis of a threat.  </p>
<p id="rfc.section.6.p.2">The specification for how a client establishes connections to servers is covered in <a href="#ObtainingMetadata" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.6.p.3">Information about the diagnosis, client, individual or scope can be attached to the upload using Assertions <a href="#Assertions" class="xref">Section 5</a>.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#UploadRequest" id="UploadRequest">Upload Request</a>
</h1>
<p id="rfc.section.6.1.p.1">The client SHOULD retrieve the request URI from the Threat Exposure Notification Server Configuration Document as defined in <a href="#ObtainingMetadata" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.6.1.p.2">The request object is a JSON object <a href="#RFC8259" class="xref">[RFC8259]</a> with the following properties: </p>

<dl>
<dt>keys</dt>
<dd style="margin-left: 8">
<br> REQUIRED. A dictionary where the key is a URI of a key type and the value is an array of strings representing the diagnosis keys for that key type.  </dd>
<dt>diagnosis</dt>
<dd style="margin-left: 8">
<br> REQUIRED. An object providing information about the diagnosis of a threat. It has the following properties: <dl>
<dt>threat</dt>
<dd style="margin-left: 8">
<br> REQUIRED. A URI of a threat that has been diagnosed, as specified in<a href="#Descriptors" class="xref">Section 4</a>.  </dd>
<dt>diagnosed</dt>
<dd style="margin-left: 8">
<br> REQUIRED. The time when the diagnosis was made formatted as specified in <a href="#RFC3339" class="xref">[RFC3339]</a> with no time zone offset.  </dd>
</dl>
<p> </p>
</dd>
<dt>assertions</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. An object providing additional assertions related to the upload, diagnosis, individual or scope.  The key is an Assertion defined as per <a href="#Assertions" class="xref">Section 5</a>.  The client MUST ignore any assertions it does not recognize.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#UploadValidation" id="UploadValidation">Upload Validation</a>
</h1>
<p id="rfc.section.6.2.p.1">The server SHOULD validate the request, including ensuring e.g., that the <samp>keys</samp> is supported, <samp>threat</samp> is supported and <samp>diagnosed </samp> is a properly formatted time <a href="#RFC3339" class="xref">[RFC3339]</a> occurring in the past.  </p>
<p id="rfc.section.6.2.p.2">The following Problem Detail Types <a href="#RFC7807" class="xref">[RFC7807]</a> are defined for validation: </p>

<dl>
<dt>https://tenprotocol.org/errors/keys-required</dt>
<dd style="margin-left: 8">
<br> The <samp>keys</samp> property is missing or is not an object or the value of one of the keys is not an array.  </dd>
<dt>https://tenprotocol.org/errors/key-not-supported</dt>
<dd style="margin-left: 8">
<br> One of the keys specified in the <samp>keys</samp> property is not supported by the server.  </dd>
<dt>https://tenprotocol.org/errors/diagnosis-required</dt>
<dd style="margin-left: 8">
<br> The <samp>diagnosis</samp> property is missing or is not an object.  </dd>
<dt>https://tenprotocol.org/errors/threat-required</dt>
<dd style="margin-left: 8">
<br> The <samp>threat</samp> property is missing or is not a string.  </dd>
<dt>https://tenprotocol.org/errors/threat-not-supported</dt>
<dd style="margin-left: 8">
<br> The threat specified in the <samp>threat</samp> property is not supported by the server.  </dd>
<dt>https://tenprotocol.org/errors/diagnosed-required</dt>
<dd style="margin-left: 8">
<br> The <samp>diagnosed</samp> property is missing or is not a string.  </dd>
<dt>https://tenprotocol.org/errors/diagnosed-invalid</dt>
<dd style="margin-left: 8">
<br> The <samp>diagnosed</samp> property is invalid.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#UploadResponse" id="UploadResponse">Upload Response</a>
</h1>
<p id="rfc.section.6.3.p.1">If the server has validated the request and accepted the upload, the server will return either a <samp>200 OK</samp> or <samp>204 No Content</samp> response code.  Clients MUST support either response as a successful upload.  </p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> <a href="#UploadError" id="UploadError">Upload Error Response</a>
</h1>
<p id="rfc.section.6.4.p.1">If the request was not validated properly, the server MUST return a <samp>400 Bad Request </samp> error response with a Problem Details Object <a href="#RFC7807" class="xref">[RFC7807]</a> containing at least the <samp>type</samp>, <samp>status</samp> and <samp>detail</samp> as specified in <a href="#RFC7807" class="xref">[RFC7807]</a>.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Query" id="Query">Querying Exposure</a>
</h1>
<p id="rfc.section.7.p.1">A client MAY query a server to determine exposure to a threat.  </p>
<p id="rfc.section.7.p.2">The specification for how a client establishes connections to servers is covered in <a href="#ObtainingMetadata" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.7.p.3">Information about the diagnosis, client, individual or scope can be attached to the upload using Assertions <a href="#Assertions" class="xref">Section 5</a>.  </p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#QueryRequest" id="QueryRequest">Query Request</a>
</h1>
<p id="rfc.section.7.1.p.1">The client SHOULD retrieve the request URI from the Threat Exposure Notification Server Configuration Document as defined in<a href="#ObtainingMetadata" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.7.1.p.2">The request object is a JSON object <a href="#RFC8259" class="xref">[RFC8259]</a> with the following properties: </p>

<dl>
<dt>keys</dt>
<dd style="margin-left: 8">
<br> REQUIRED. A dictionary where the key is an URI of a key type and the value is an array of strings representing the keys for that key type.  </dd>
<dt>before</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. A date to search for exposures before, formatted as specified in <a href="#RFC3339" class="xref">[RFC3339]</a> with no time zone offset.  </dd>
<dt>after</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. A date to search for exposures after, formatted as specified in <a href="#RFC3339" class="xref">[RFC3339]</a> with no time zone offset. If omitted, the server SHOULD provide a reasonable default based on the specified threats.  </dd>
<dt>threats</dt>
<dd style="margin-left: 8">
<br> REQUIRED. Array of strings specifying which threats to check for exposure to<a href="#Descriptors" class="xref">Section 4</a>.  </dd>
<dt>assertions</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. An object providing additional assertions related to the upload, diagnosis, individual or scope.  The key is an Assertion defined as per <a href="#Assertions" class="xref">Section 5</a>.  The client MUST ignore any assertions it does not recognize.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#QueryValidation" id="QueryValidation">Query Validation</a>
</h1>
<p id="rfc.section.7.2.p.1">The server SHOULD validate the request, including ensuring e.g., that the <samp>key</samp> is supported, <samp>threats</samp> are supported, and so on.  </p>
<p id="rfc.section.7.2.p.2">The following Problem Detail Types <a href="#RFC7807" class="xref">[RFC7807]</a> are defined for validation: </p>

<dl>
<dt>https://tenprotocol.org/errors/keys-required</dt>
<dd style="margin-left: 8">
<br> The <samp>keys</samp> property is missing or is not an object or the value of one of the keys is not an array.  </dd>
<dt>https://tenprotocol.org/errors/key-not-supported</dt>
<dd style="margin-left: 8">
<br> One of the keys specified in the <samp>keys</samp> property is not supported by the server.  </dd>
<dt>https://tenprotocol.org/errors/threats-required</dt>
<dd style="margin-left: 8">
<br> The <samp>threats</samp> property is missing or is not an array of strings.  </dd>
<dt>https://tenprotocol.org/errors/threat-not-supported</dt>
<dd style="margin-left: 8">
<br> The threat specified in the <samp>threat</samp> property is not supported by the server.  </dd>
<dt>https://tenprotocol.org/errors/before-invalid</dt>
<dd style="margin-left: 8">
<br> The <samp>before</samp> property is invalid.  </dd>
<dt>https://tenprotocol.org/errors/after-invalid</dt>
<dd style="margin-left: 8">
<br> The <samp>after</samp> property is invalid.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#QueryResponse" id="QueryResponse">Query Response</a>
</h1>
<p id="rfc.section.7.3.p.1">If the server has validated the request and accepted the query, the server will return a <samp>200 OK</samp> response with a <samp>Content-Type</samp> header equal to <samp>application/json</samp>.  </p>
<p id="rfc.section.7.3.p.2">The request object is a JSON object <a href="#RFC8259" class="xref">[RFC8259]</a> with the following properties: </p>

<dl>
<dt>exposed</dt>
<dd style="margin-left: 8">
<br> REQUIRED. A dictionary of exposures to the threats. The key of the dictionary is the threat URI as defined in <a href="#Descriptors" class="xref">Section 4</a> and the value is a boolean denoting whether an exposure to the condition has been flagged.  </dd>
<dt>exposures</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. An array of days when exposures happened formatted as per <a href="#RFC3339" class="xref">[RFC3339]</a> without a time component.  </dd>
<dt>message</dt>
<dd style="margin-left: 8">
<br> A human-readable message to be displayed to the user.  </dd>
<dt>links</dt>
<dd style="margin-left: 8">
<br> A list of WebLinks for more information ( <a href="#RFC7033" class="xref">[RFC7033]</a> <a href="#RFC8288" class="xref">[RFC8288]</a>).  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> <a href="#QueryError" id="QueryError">Query Error Response</a>
</h1>
<p id="rfc.section.7.4.p.1">If the request was not validated properly, the server MUST return a <samp>400 Bad Request </samp> error response with a Problem Details Object <a href="#RFC7807" class="xref">[RFC7807]</a> containing at least the <samp>type</samp>, <samp>status</samp> and <samp>detail</samp> as specified in<a href="#RFC7807" class="xref">[RFC7807]</a>.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Fetch" id="Fetch">Fetching Diagnosis Keys</a>
</h1>
<p id="rfc.section.8.p.1">A client MAY ask to remove diagnosis keys it previously uploaded to a server.  </p>
<p id="rfc.section.8.p.2">The specification for how a client establishes connections to servers is covered in <a href="#ObtainingMetadata" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.8.p.3">Information about the diagnosis, client, individual or scope can be attached to the upload using Assertions <a href="#Assertions" class="xref">Section 5</a>.  </p>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#FetchRequest" id="FetchRequest">Fetch Request</a>
</h1>
<p id="rfc.section.8.1.p.1">The client SHOULD retrieve the request URI from the Threat Exposure Notification Server Configuration Document as defined in <a href="#ObtainingMetadata" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.8.1.p.2">The request object is a JSON object <a href="#RFC8259" class="xref">[RFC8259]</a> with the following properties: </p>

<dl>
<dt>keys</dt>
<dd style="margin-left: 8">
<br> REQUIRED. An array of URI's for the requested key types.  </dd>
<dt>before</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. A date to search for exposures before, formatted as specified in <a href="#RFC3339" class="xref">[RFC3339]</a> with no time zone offset.  </dd>
<dt>after</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. A date to search for exposures after, formatted as specified in <a href="#RFC3339" class="xref">[RFC3339]</a> with no time zone offset. If omitted, the server SHOULD provide a reasonable default based on the specified threats.  </dd>
<dt>threats</dt>
<dd style="margin-left: 8">
<br> REQUIRED. Array of strings specifying which threats to check for exposure to<a href="#Descriptors" class="xref">Section 4</a>.  </dd>
<dt>assertions</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. An object providing additional assertions related to the upload, diagnosis, individual or scope.  The key is an Assertion defined as per <a href="#Assertions" class="xref">Section 5</a>.  The client MUST ignore any assertions it does not recognize.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> <a href="#FetchValidation" id="FetchValidation">Fetch Validation</a>
</h1>
<p id="rfc.section.8.2.p.1">The server SHOULD validate the request, including ensuring e.g., that the <samp>keys</samp> are supported, <samp>threats</samp> are supported, and so on.  </p>
<p id="rfc.section.8.2.p.2">The following Problem Detail Types <a href="#RFC7807" class="xref">[RFC7807]</a> are defined for validation: </p>

<dl>
<dt>https://tenprotocol.org/errors/keys-required</dt>
<dd style="margin-left: 8">
<br> The <samp>keys</samp> property is missing or is not an array.  </dd>
<dt>https://tenprotocol.org/errors/key-not-supported</dt>
<dd style="margin-left: 8">
<br> One of the keys specified in the <samp>keys</samp> property is not supported by the server.  </dd>
<dt>https://tenprotocol.org/errors/threats-required</dt>
<dd style="margin-left: 8">
<br> The <samp>threats</samp> property is missing or is not an array of strings.  </dd>
<dt>https://tenprotocol.org/errors/threat-not-supported</dt>
<dd style="margin-left: 8">
<br> The threat specified in the <samp>threat</samp> property is not supported by the server.  </dd>
<dt>https://tenprotocol.org/errors/before-invalid</dt>
<dd style="margin-left: 8">
<br> The <samp>before</samp> property is invalid.  </dd>
<dt>https://tenprotocol.org/errors/after-invalid</dt>
<dd style="margin-left: 8">
<br> The <samp>after</samp> property is invalid.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> <a href="#FetchResponse" id="FetchResponse">Fetch Response</a>
</h1>
<p id="rfc.section.8.3.p.1">If the server has validated the request and accepted the fetch, the server will return a <samp>200 OK</samp> response with a <samp>Content-Type</samp> header equal to <samp>application/json</samp>.  </p>
<p id="rfc.section.8.3.p.2">The client and server SHOULD support Chunked Transfer Encoding <a href="#RFC7230" class="xref">[RFC7230]</a> as the resulting response entity may be large.  </p>
<p id="rfc.section.8.3.p.3">The request object is a JSON object <a href="#RFC8259" class="xref">[RFC8259]</a> with the following properties: </p>

<dl>
<dt>keys</dt>
<dd style="margin-left: 8">
<br> REQUIRED. A dictionary where the key is a URI of a key type and the value is an array of strings representing the diagnosis keys for that key type.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.8.4">
<a href="#rfc.section.8.4">8.4.</a> <a href="#FetchError" id="FetchError">Fetch Error</a>
</h1>
<p id="rfc.section.8.4.p.1">If the request was not validated properly, the server MUST return a <samp>400 Bad Request </samp> error response with a Problem Details Object <a href="#RFC7807" class="xref">[RFC7807]</a> containing at least the <samp>type</samp>, <samp>status</samp> and <samp>detail</samp> as specified in <a href="#RFC7807" class="xref">[RFC7807]</a>.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#Revoke" id="Revoke">Revoking Diagnosis Keys</a>
</h1>
<p id="rfc.section.9.p.1">A client MAY ask to remove diagnosis keys it previously uploaded to a server.  </p>
<p id="rfc.section.9.p.2">The specification for how a client establishes connections to servers is covered in <a href="#ObtainingMetadata" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.9.p.3">Information about the diagnosis, client, individual or scope can be attached to the upload using assertions <a href="#Assertions" class="xref">Section 5</a>.  </p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#RevokeRequest" id="RevokeRequest">Revoke Request</a>
</h1>
<p id="rfc.section.9.1.p.1">The client SHOULD retrieve the request URI from the Threat Exposure Notification Server Configuration Document as defined in <a href="#ObtainingMetadata" class="xref">Section 3.2</a>.  </p>
<p id="rfc.section.9.1.p.2">The request object is a JSON object <a href="#RFC8259" class="xref">[RFC8259]</a> with the following properties: </p>

<dl>
<dt>keys</dt>
<dd style="margin-left: 8">
<br> REQUIRED. A dictionary where the key is a URI of a key type and the value is an array of strings representing the diagnosis keys for that key type.  </dd>
<dt>assertions</dt>
<dd style="margin-left: 8">
<br> OPTIONAL. An object providing additional assertions related to the upload, diagnosis, individual or scope.  The key is an Assertion defined as per <a href="#Assertions" class="xref">Section 5</a>.  The client MUST ignore any assertions it does not recognize.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> <a href="#RevokeValidation" id="RevokeValidation">Revoke Validation</a>
</h1>
<p id="rfc.section.9.2.p.1">The server SHOULD validate the request, including ensuring e.g., that the <samp>keys</samp> is supported.  </p>
<p id="rfc.section.9.2.p.2">The following Problem Detail Types <a href="#RFC7807" class="xref">[RFC7807]</a> are defined for validation: </p>

<dl>
<dt>https://tenprotocol.org/errors/keys-required</dt>
<dd style="margin-left: 8">
<br> The <samp>keys</samp> property is missing or is not an object or the value of one of the keys is not an array.  </dd>
<dt>https://tenprotocol.org/errors/key-not-supported</dt>
<dd style="margin-left: 8">
<br> One of the keys specified in the <samp>keys</samp> property is not supported by the server.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> <a href="#RevokeResponse" id="RevokeResponse">Revoke Response</a>
</h1>
<p id="rfc.section.9.3.p.1">If the server has validated the request and accepted the upload, the server will return either a <samp>200 OK</samp> or <samp>204 No Content</samp> response code.  Clients MUST support either response as a successful upload.  </p>
<h1 id="rfc.section.9.4">
<a href="#rfc.section.9.4">9.4.</a> <a href="#RevokeError" id="RevokeError">Revoke Error</a>
</h1>
<p id="rfc.section.9.4.p.1">If the request was not validated properly, the server MUST return a <samp>400 Bad Request </samp> error response with a Problem Details Object <a href="#RFC7807" class="xref">[RFC7807]</a> containing at least the <samp>type</samp>, <samp>status</samp> and <samp>detail</samp> as specified in <a href="#RFC7807" class="xref">[RFC7807]</a>.  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> <a href="#Auth" id="Auth">Authentication and Authorization</a>
</h1>
<p id="rfc.section.10.1.p.1">This specification does not specify a method for authorizing calls to the server. Calls to the endpoints may even be unauthenticated, depending on the server configuration.  </p>
<h1 id="rfc.section.10.2">
<a href="#rfc.section.10.2">10.2.</a> <a href="#Privacy" id="Privacy">Privacy Considerations</a>
</h1>
<p id="rfc.section.10.2.p.1">While the Assertions mechanism allows the requests to be augmented, it is up to the client and server to ensure that any assertions provided to not expose any personally identifiable information (PII).  </p>
<h1 id="rfc.section.10.3">
<a href="#rfc.section.10.3">10.3.</a> <a href="#TLS" id="TLS">TLS Requirements</a>
</h1>
<p id="rfc.section.10.3.p.1">Implementations MUST support TLS. Which version(s) ought to be implemented will vary over time and depend on the widespread deployment and known security vulnerabilities at the time of implementation. The authorization server MUST support TLS version 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a> and MAY support additional TLS mechanisms meeting its security requirements. When using TLS, the client MUST perform a TLS/SSL server certificate check, per <a href="#RFC6125" class="xref">[RFC6125]</a>.  Implementation security considerations can be found in "Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)" <a href="#RFC7525" class="xref">[RFC7525]</a>.  </p>
<p id="rfc.section.10.3.p.2">To protect against information disclosure and tampering, confidentiality protection MUST be applied using TLS with a ciphersuite that provides confidentiality and integrity protection.  </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.11.p.1">The following registration procedure is used for the registry established by this specification.  </p>
<p id="rfc.section.11.p.2">Values are registered on a Specification Required <a href="#RFC8126" class="xref">[RFC8126]</a> basis after a two-week review period on the tenp-ext-review@tenprotocol.org mailing list, on the advice of one or more Designated Experts.  However, to allow for the allocation of values prior to publication, the Designated Experts may approve registration once they are satisfied that such a specification will be published.  </p>
<p id="rfc.section.11.p.3">Registration requests sent to the mailing list for review should use an appropriate subject (e.g., "Request to register Threat Exposure Notification Server Metadata: example").  </p>
<p id="rfc.section.11.p.4">Within the review period, the Designated Experts will either approve or deny the registration request, communicating this decision to the review list and IANA.  Denials should include an explanation and, if applicable, suggestions as to how to make the request successful.  Registration requests that are undetermined for a period longer than 21 days can be brought to the IESG's attention (using the iesg@ietf.org mailing list) for resolution.  </p>
<p id="rfc.section.11.p.5">Criteria that should be applied by the Designated Experts include determining whether the proposed registration duplicates existing functionality, determining whether it is likely to be of general applicability or whether it is useful only for a single application, and whether the registration makes sense.  </p>
<p id="rfc.section.11.p.6">IANA must only accept registry updates from the Designated Experts and should direct all requests for registration to the review mailing list.  </p>
<p id="rfc.section.11.p.7">It is suggested that multiple Designated Experts be appointed who are able to represent the perspectives of different applications using this specification, in order to enable broadly-informed review of registration decisions.  In cases where a registration decision could be perceived as creating a conflict of interest for a particular Designated Expert, that Designated Expert should defer to the judgment of the other Designated Experts.  </p>
<h1 id="rfc.section.11.1">
<a href="#rfc.section.11.1">11.1.</a> <a href="#MetadataReg" id="MetadataReg">Threat Exposure Notification Server Metadata Registry</a>
</h1>
<p id="rfc.section.11.1.p.1">This specification establishes the IANA "Threat Exposure Notification Server Metadata" registry for Threat Exposure Notification Server metadata names.  The registry records the Threat Exposure Notification Server metadata member and a reference to the specification that defines it.  </p>
<p id="rfc.section.11.1.p.2">The Designated Experts must either: </p>
<p id="rfc.section.11.1.p.3">(a) require that metadata names and values being registered use only printable ASCII characters excluding double quote ('"') and backslash ('\') (the Unicode characters with code points U+0021, U+0023 through U+005B, and U+005D through U+007E), or </p>
<p id="rfc.section.11.1.p.4">(b) if new metadata members or values are defined that use other code points, require that their definitions specify the exact sequences of Unicode code points used to represent them.  Furthermore, proposed registrations that use Unicode code points that can only be represented in JSON strings as escaped characters must not be accepted.  </p>
<h1 id="rfc.section.11.1.1">
<a href="#rfc.section.11.1.1">11.1.1.</a> <a href="#MetadataTemplate" id="MetadataTemplate">Registration Template</a>
</h1>
<p></p>

<dl>
<dt>Metadata Name:</dt>
<dd style="margin-left: 8">
<br> The name requested (e.g., "query_endpoint").  This name is case-sensitive.  Names may not match other registered names in a case-insensitive manner (one that would cause a match if the Unicode toLowerCase() operation were applied to both strings) unless the Designated Experts state that there is a compelling reason to allow an exception.  </dd>
<dt>Metadata Description:</dt>
<dd style="margin-left: 8">
<br> Brief description of the metadata (e.g., "Query Endpoint URL").  </dd>
<dt>Metadata Type:</dt>
<dd style="margin-left: 8">
<br> Description of the metadata type (e.g., string, boolean, number) and whether multiple values are expected (e.g., array of strings, array of numbers).  </dd>
<dt>Change Controller:</dt>
<dd style="margin-left: 8">
<br> For Standards Track RFCs, list the "IESG".  For others, give the name of the responsible party.  Other details (e.g., postal address, email address, home page URI) may also be included.  </dd>
<dt>Specification Document(s):</dt>
<dd style="margin-left: 8">
<br> Reference to the document or documents that specify the parameter, preferably including URIs that can be used to retrieve copies of the documents.  An indication of the relevant sections may also be included but is not required.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.11.1.2">
<a href="#rfc.section.11.1.2">11.1.2.</a> <a href="#MetadataContents" id="MetadataContents">Initial Registry Contents</a>
</h1>
<p></p>

<ul>
<li>Metadata Name: supports_query </li>
<li>Metadata Type: boolean </li>
<li>Metadata Description: Value indicating whether the server supports the Query operation.  </li>
<li>Change Controller: tenp-ext-review@tenprotocol.org </li>
<li>Specification Document(s): <a href="#Metadata" class="xref">Section 3</a> of this specification.  </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Metadata Name: query_endpoint </li>
<li>Metadata Type: string </li>
<li>Metadata Description: URL of the server's Query endpoint.  </li>
<li>Change Controller: tenp-ext-review@tenprotocol.org </li>
<li>Specification Document(s): <a href="#Metadata" class="xref">Section 3</a> of this specification.  </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Metadata Name: supports_upload </li>
<li>Metadata Type: boolean </li>
<li>Metadata Description: Value indicating whether the server supports the Upload operation.  </li>
<li>Change Controller: tenp-ext-review@tenprotocol.org </li>
<li>Specification Document(s): <a href="#Metadata" class="xref">Section 3</a> of this specification.  </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Metadata Name: upload_endpoint </li>
<li>Metadata Type: string </li>
<li>Metadata Description: URL of the server"s Upload endpoint.  </li>
<li>Change Controller: tenp-ext-review@tenprotocol.org </li>
<li>Specification Document(s): <a href="#Metadata" class="xref">Section 3</a> of this specification.  </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Metadata Name: keys_supported </li>
<li>Metadata Type: array of string </li>
<li>Metadata Description: Array of strings of URI's that designated which keys are supported.  </li>
<li>Change Controller: tenp-ext-review@tenprotocol.org </li>
<li>Specification Document(s): <a href="#Metadata" class="xref">Section 3</a> of this specification.  </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Metadata Name: threats_supported </li>
<li>Metadata Type: array of string </li>
<li>Metadata Description: Array of strings of Threat Descriptors<a href="#Descriptors" class="xref">Section 4</a>.  </li>
<li>Change Controller: tenp-ext-review@tenprotocol.org </li>
<li>Specification Document(s): <a href="#Metadata" class="xref">Section 3</a> of this specification.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.11.2">
<a href="#rfc.section.11.2">11.2.</a> <a href="#WellknownRegistry" id="WellknownRegistry">Well-Known URI Registry</a>
</h1>
<p id="rfc.section.11.2.p.1">This specification registers the well-known URI defined in <a href="#ObtainingMetadata" class="xref">Section 3.2</a> in the IANA Well-Known URI registry defined in <a href="#RFC8615" class="xref">[RFC8615]</a>.  </p>
<h1 id="rfc.section.11.2.1">
<a href="#rfc.section.11.2.1">11.2.1.</a> <a href="#WellknownContents" id="WellknownContents">Registry Contents</a>
</h1>
<p></p>

<ul>
<li>URI suffix: <samp>threat-exposure-configuration</samp> </li>
<li>Change controller: IESG</li>
<li>Specification document: <a href="#ObtainingMetadata" class="xref">Section 3.2</a> of this specification.  </li>
<li>Related information: (none)</li>
</ul>

<p> </p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">12.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="IANA.well-known">[IANA.well-known]</b></td>
<td class="top">
<a>IANA</a>, "<a href="http://www.iana.org/assignments/well-known-uris">Well-Known URIs</a>"</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3339">[RFC3339]</b></td>
<td class="top">
<a>Klyne, G.</a> and <a>C. Newman</a>, "<a href="https://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>", RFC 3339, DOI 10.17487/RFC3339, July 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6125">[RFC6125]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="https://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, DOI 10.17487/RFC6125, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6415">[RFC6415]</b></td>
<td class="top">
<a>Hammer-Lahav, E.</a> and <a>B. Cook</a>, "<a href="https://tools.ietf.org/html/rfc6415">Web Host Metadata</a>", RFC 6415, DOI 10.17487/RFC6415, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7033">[RFC7033]</b></td>
<td class="top">
<a>Jones, P.</a>, <a>Salgueiro, G.</a>, <a>Jones, M.</a> and <a>J. Smarr</a>, "<a href="https://tools.ietf.org/html/rfc7033">WebFinger</a>", RFC 7033, DOI 10.17487/RFC7033, September 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7230">[RFC7230]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>", RFC 7230, DOI 10.17487/RFC7230, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7525">[RFC7525]</b></td>
<td class="top">
<a>Sheffer, Y.</a>, <a>Holz, R.</a> and <a>P. Saint-Andre</a>, "<a href="https://tools.ietf.org/html/rfc7525">Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</a>", BCP 195, RFC 7525, DOI 10.17487/RFC7525, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7807">[RFC7807]</b></td>
<td class="top">
<a>Nottingham, M.</a> and <a>E. Wilde</a>, "<a href="https://tools.ietf.org/html/rfc7807">Problem Details for HTTP APIs</a>", RFC 7807, DOI 10.17487/RFC7807, March 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8126">[RFC8126]</b></td>
<td class="top">
<a>Cotton, M.</a>, <a>Leiba, B.</a> and <a>T. Narten</a>, "<a href="https://tools.ietf.org/html/rfc8126">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 8126, DOI 10.17487/RFC8126, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8259">[RFC8259]</b></td>
<td class="top">
<a>Bray, T.</a>, "<a href="https://tools.ietf.org/html/rfc8259">The JavaScript Object Notation (JSON) Data Interchange Format</a>", STD 90, RFC 8259, DOI 10.17487/RFC8259, December 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8288">[RFC8288]</b></td>
<td class="top">
<a>Nottingham, M.</a>, "<a href="https://tools.ietf.org/html/rfc8288">Web Linking</a>", RFC 8288, DOI 10.17487/RFC8288, October 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8615">[RFC8615]</b></td>
<td class="top">
<a>Nottingham, M.</a>, "<a href="https://tools.ietf.org/html/rfc8615">Well-Known Uniform Resource Identifiers (URIs)</a>", RFC 8615, DOI 10.17487/RFC8615, May 2019.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">12.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="pact">[pact]</b></td>
<td class="top">
<a title="MIT">Rivest, R.</a>, <a title="ACLU">Callas, J.</a>, <a title="Boston University">Canetti, R.</a>, <a title="Massachusetts Institute of Technology">Esvelt, K.</a>, <a title="American Civil Liberties Union">Gillmor, D.</a>, <a title="Massachusetts Institute of Technology">Kalai, Y.</a>, <a title="Brown University">Lysyanskaya, A.</a>, <a title="MIT Lincoln Laboratory">Norige, A.</a>, <a title="Massachusetts Institute of Technology">Raskar, R.</a>, <a title="Weizmann Institute">Shamir, A.</a>, <a title="MIT Lincoln Laboratory">Shen, E.</a>, <a title="MIT Lincoln Laboratory">Soibelman, I.</a>, <a title="Massachusetts Institute of Technology">Specter, M.</a>, <a title="Thinking Cybersecurity">Teague, V.</a>, <a title="Boston University">Trachtenberg, A.</a>, <a title="Boston University">Varia, M.</a>, <a title="MIT Lincoln Laboratory">Viera, M.</a>, <a title="Massachusetts Institute of Technology">Weitzner, D.</a>, <a title="MIT Lincoln Laboratory">Wilkinson, J.</a> and <a title="MIT Lincoln Laboratory">M. Zissman</a>, "<a href="https://pact.mit.edu/wp-content/uploads/2020/04/The-PACT-protocol-specification-ver-0.1.pdf">The PACT protocol specification</a>"</td>
</tr>
<tr>
<td class="reference"><b id="who">[who]</b></td>
<td class="top">
<a>World Health Organization (WHO)</a> and <a>Center for Disease Control and Prevention (CDC)</a>, "<a href="https://apps.who.int/iris/bitstream/handle/10665/185258/WHO_EVD_Guidance_Contact_15.1_eng.pdf">Emergency Guideline - Implementation and management of contact tracing for Ebola virus disease</a>", September 2015.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> Configuration Examples (Non-normative)</h1>
<h1 id="rfc.appendix.A.1">
<a href="#rfc.appendix.A.1">A.1.</a> Example Configuration Request</h1>
<pre>
GET /.well-known/threat-exposure-configuration HTTP/1.1
Accept: application/json
Host: example.com
                        </pre>
<p id="rfc.section.A.1.p.1">The client would make the following request to the server <samp>https://example.com</samp> to obtain its Configuration document: </p>
<h1 id="rfc.appendix.A.2">
<a href="#rfc.appendix.A.2">A.2.</a> Example Configuration Response</h1>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
  "supports_query": true,
  "query_endpoint": "https://server.example.com/query",
  "supports_upload": true,
  "upload_endpoint": "https://server.example.com/upload",
  "keys_supported": ["https://tenprotocol.org/keys/btle"],
  "threats_supported": ["https://tenprotocol.org/threats/covid19"],
  "assertions_supported": ["https://tenprotocol.org/assertions/
    geo/country/1.0", "https://tenprotocol.org/assertions/geo/
    state/1.0"]
}
                        </pre>
<p id="rfc.section.A.2.p.1">The following is a non-normative example response: </p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> Upload Examples (Non-normative)</h1>
<h1 id="rfc.appendix.B.1">
<a href="#rfc.appendix.B.1">B.1.</a> Example Upload Request</h1>
<pre>
POST /threat-exposure/upload HTTP/1.1
Host: example.com
Content-Type: application/json
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
    "keys": {
        "https://tenprotocol.org/keys/btle": [
            "1478E46F897749C691A28351F0B054F1",
            "20A7412C65A046DCB5538D7DA45A6B5D",
            "24BFE7A43563495BA36C79A96617A602",
            "371108A73B964915A62D81E49A783F85",
            "4075DB637A914896B5459EF3E377AF0D",
            "5F51F91099B84C9685CD268941A3DEEC",
            "67684C56F9A6407A99DB57E6B871EC1D",
            "AA0817D30C64407CB4F5DE1425336922",
            "CFC046DEF50244D58CA58A0AD7FED287",
            "D555096A727C49FEADD03488154E6152",
            "E48A37FB87924885AD6879857DC297B2"
        ]
    },
    "diagnosis": {
        "threat": "https://tenprotocol.org/threats/diseases/covid19",
        "diagnosed": "2020-05-01T01:23:45"
    },
    "assertions": {
        "https://tenprotocol.org/assertions/geo/country/1.0": ["US"],
        "https://tenprotocol.org/assertions/geo/state/1.0": ["CA"]
    }
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.B.2">
<a href="#rfc.appendix.B.2">B.2.</a> Example Upload Successful Response</h1>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{}
                        </pre>
<p></p>
<h1 id="rfc.appendix.B.3">
<a href="#rfc.appendix.B.3">B.3.</a> Example Upload Empty Response</h1>
<pre>
HTTP/1.1 204 No Content
                        </pre>
<p></p>
<h1 id="rfc.appendix.B.4">
<a href="#rfc.appendix.B.4">B.4.</a> Example Upload Error Response</h1>
<pre>
HTTP/1.1 400 Bad Request
Content-Type: application/problem+json
Content-Language: en

{
    "type": "https://tenprotocol.org/errors/key-not-supported",
    "status": "400",
    "detail": "The specified key is not supported."
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.C">
<a href="#rfc.appendix.C">Appendix C.</a> Query Examples (Non-normative)</h1>
<h1 id="rfc.appendix.C.1">
<a href="#rfc.appendix.C.1">C.1.</a> Example Query Request</h1>
<pre>
POST /threat-exposure/query HTTP/1.1
Host: example.com
Content-Type: application/json
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
    "keys": {
        "https://tenprotocol.org/keys/btle": [
            "1478E46F897749C691A28351F0B054F1",
            "20A7412C65A046DCB5538D7DA45A6B5D",
            "24BFE7A43563495BA36C79A96617A602",
            "371108A73B964915A62D81E49A783F85",
            "4075DB637A914896B5459EF3E377AF0D",
            "5F51F91099B84C9685CD268941A3DEEC",
            "67684C56F9A6407A99DB57E6B871EC1D",
            "AA0817D30C64407CB4F5DE1425336922",
            "CFC046DEF50244D58CA58A0AD7FED287",
            "D555096A727C49FEADD03488154E6152",
            "E48A37FB87924885AD6879857DC297B2"
        ]
    },
    "after": "2020-04-01T00:00:00",
    "threats": [
        "https://tenprotocol.org/threats/diseases/covid19"
    ],
    "assertions": {
        "https://tenprotocol.org/assertions/geo/country/1.0": ["US"],
        "https://tenprotocol.org/assertions/geo/state/1.0": ["CA"]
    }
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.C.2">
<a href="#rfc.appendix.C.2">C.2.</a> Example Query Response</h1>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Content-Language: en

{
    "exposed": {
        "https://tenprotocol.org/threats/diseases/covid19": true
    },
    "exposures": ["2020-04-20"],
    "message": "You were exposed to COVID-19 on April 20th 2020.
       Please contact your local health authority.",
    "links": [
        {
            "href": "http://somehealth.org/covid19.html",
            "rel": "details"
        },
        {
            "href": "http://somehealth.org/privacy-policy.html",
            "rel": "privacy"
        },
    ]
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.C.3">
<a href="#rfc.appendix.C.3">C.3.</a> Example Query Error Response</h1>
<pre>
HTTP/1.1 400 Bad Request
Content-Type: application/problem+json
Content-Language: en

{
    "type": "https://tenprotocol.org/errors/key-not-supported",
    "status": "400",
    "detail": "The specified key is not supported."
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.D">
<a href="#rfc.appendix.D">Appendix D.</a> Fetch Examples (Non-normative)</h1>
<h1 id="rfc.appendix.D.1">
<a href="#rfc.appendix.D.1">D.1.</a> Example Fetch Request</h1>
<pre>
POST /threat-exposure/fetch HTTP/1.1
Host: example.com
Content-Type: application/json
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
    "keys": [
        "https://tenprotocol.org/keys/btle"
    ],
    "after": "2020-04-01T00:00:00",
    "threats": [
        "https://tenprotocol.org/threats/diseases/covid19"
    ],
    "assertions": {
        "https://tenprotocol.org/assertions/geo/country/1.0": ["US"],
        "https://tenprotocol.org/assertions/geo/state/1.0": ["CA"]
    }
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.D.2">
<a href="#rfc.appendix.D.2">D.2.</a> Example Fetch Response</h1>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Content-Language: en

{
    "keys": {
        "https://tenprotocol.org/keys/btle": [
            "1478E46F897749C691A28351F0B054F1",
            "20A7412C65A046DCB5538D7DA45A6B5D",
            "24BFE7A43563495BA36C79A96617A602",
            "371108A73B964915A62D81E49A783F85",
            "4075DB637A914896B5459EF3E377AF0D",
            "5F51F91099B84C9685CD268941A3DEEC",
            "67684C56F9A6407A99DB57E6B871EC1D",
            "AA0817D30C64407CB4F5DE1425336922",
            "CFC046DEF50244D58CA58A0AD7FED287",
            "D555096A727C49FEADD03488154E6152",
            "E48A37FB87924885AD6879857DC297B2"
        ]
    }
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.D.3">
<a href="#rfc.appendix.D.3">D.3.</a> Example Fetch Error Response</h1>
<pre>
HTTP/1.1 400 Bad Request
Content-Type: application/problem+json
Content-Language: en

{
    "type": "https://tenprotocol.org/errors/key-not-supported",
    "status": "400",
    "detail": "The specified key is not supported."
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.E">
<a href="#rfc.appendix.E">Appendix E.</a> Revoke Examples (Non-normative)</h1>
<h1 id="rfc.appendix.E.1">
<a href="#rfc.appendix.E.1">E.1.</a> Example Revoke Request</h1>
<pre>
DELETE /threat-exposure/revoke HTTP/1.1
Host: example.com
Content-Type: application/json
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

{
    "keys": {
        "https://tenprotocol.org/keys/btle": [
            "1478E46F897749C691A28351F0B054F1",
            "20A7412C65A046DCB5538D7DA45A6B5D",
            "24BFE7A43563495BA36C79A96617A602",
            "371108A73B964915A62D81E49A783F85",
            "4075DB637A914896B5459EF3E377AF0D",
            "5F51F91099B84C9685CD268941A3DEEC",
            "67684C56F9A6407A99DB57E6B871EC1D",
            "AA0817D30C64407CB4F5DE1425336922",
            "CFC046DEF50244D58CA58A0AD7FED287",
            "D555096A727C49FEADD03488154E6152",
            "E48A37FB87924885AD6879857DC297B2"
        ]
    },
    "assertions": {
        "https://tenprotocol.org/assertions/geo/country/1.0": ["US"],
        "https://tenprotocol.org/assertions/geo/state/1.0": ["CA"]
    }
}
                        </pre>
<p></p>
<h1 id="rfc.appendix.E.2">
<a href="#rfc.appendix.E.2">E.2.</a> Example Revoke Successful Response</h1>
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{}
                        </pre>
<p></p>
<h1 id="rfc.appendix.E.3">
<a href="#rfc.appendix.E.3">E.3.</a> Example Revoke Empty Response</h1>
<pre>
HTTP/1.1 204 No Content
                        </pre>
<p></p>
<h1 id="rfc.appendix.E.4">
<a href="#rfc.appendix.E.4">E.4.</a> Example Revoke Error Response</h1>
<pre>
HTTP/1.1 400 Bad Request
Content-Type: application/problem+json
Content-Language: en

{
    "type": "https://tenprotocol.org/errors/key-not-supported",
    "status": "400",
    "detail": "The specified key is not supported."
}
                        </pre>
<p></p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Seth Yates</span> 
	  <span class="n hidden">
		<span class="family-name">Yates</span>
	  </span>
	</span>
	<span class="org vcardline">Switchbit, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:seth@switchbit.com">seth@switchbit.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yacov Salomon</span> 
	  <span class="n hidden">
		<span class="family-name">Salomon</span>
	  </span>
	</span>
	<span class="org vcardline">Switchbit, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:yacov@switchbit.com">yacov@switchbit.com</a></span>

  </address>
</div>

</body>
</html>
